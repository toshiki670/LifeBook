#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

# Read stdin for ref information
# Format: <local ref> <local sha> <remote ref> <remote sha>
while read local_ref local_sha remote_ref remote_sha
do
  # Skip if the remote ref is empty
  if [ -z "$remote_ref" ]; then
    continue
  fi
  
  # Check if pushing to main branch
  if [ "$remote_ref" = "refs/heads/main" ]; then
    echo "ERROR: Direct pushes to 'main' branch are not allowed."
    echo ""
    echo "Please follow this workflow instead:"
    echo "1. Push to your feature branch: git push origin <your-branch-name>"
    echo "2. Create a Pull Request on GitHub"
    echo "3. Have the PR reviewed and approved"
    echo "4. Merge through GitHub's interface"
    echo ""
    echo "If you need to update a feature branch:"
    echo "  git push origin <feature-branch-name>"
    exit 1
  fi
done

